

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>ZINB &mdash; TRANSIT v4.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/default.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Pathway Enrichment Analysis" href="pathway_enrichment_method.html" />
    <link rel="prev" title="ANOVA" href="anova_method.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> TRANSIT
          

          
            
            <img src="_static/transit_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                v4.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">TRANSIT MANUAL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="transit_overview.html">TRANSIT Overview (4.0)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#typical-workflow">Typical Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#tpp-transit-pre-processor">TPP (Transit Pre-Processor)</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#combined-wig-and-metadata-files">Combined_wig and Metadata Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#genome-annotations-prot-tables-and-gff-files">Genome Annotations (.prot_tables and .gff files)</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#gui">GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#pre-processing-tasks">Pre-Processing Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#statistical-analysis-methods">Statistical Analysis Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#analyses-for-tn5-datasets">Analyses for Tn5 Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#results-and-post-processing">Results and Post-Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#command-line">Command Line</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#developers">Developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="transit_install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="transit_install.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_install.html#python-3">Python 3:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="transit_install.html#additional-requirements-r-statistical-analysis-package">Additional Requirements: R (statistical analysis package)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="transit_install.html#optional-install-bwa-to-use-with-tpp-pre-processor">Optional: Install BWA to use with TPP pre-processor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="transit_install.html#linux-osx-instructions">Linux &amp; OSX Instructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="transit_install.html#windows-instructions">Windows Instructions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="transit_install.html#upgrading">Upgrading</a><ul>
<li class="toctree-l3"><a class="reference internal" href="transit_install.html#method-1-upgrading-package-installation">Method 1: Upgrading package installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="transit_install.html#method-2-upgrading-source-installation">Method 2: Upgrading source installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="transit_install.html#installing-wxpython">Installing wxPython</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_install.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="transit_install.html#no-window-appears-when-running-in-gui-mode">1. No window appears when running in GUI mode.</a></li>
<li class="toctree-l3"><a class="reference internal" href="transit_install.html#pip3-systemerror-cannot-compile-python-h">2. pip3: SystemError: Cannot compile ‘Python.h’.</a></li>
<li class="toctree-l3"><a class="reference internal" href="transit_install.html#pip-the-following-required-packages-can-not-be-built-freetype-png-etc">3. pip: “The following required packages can not be built: freetype,png,” etc.</a></li>
<li class="toctree-l3"><a class="reference internal" href="transit_install.html#pip3-no-lapack-blas-resources-found">4. pip3: “No lapack/blas resources found”</a></li>
<li class="toctree-l3"><a class="reference internal" href="transit_install.html#resources-contextualversionconflict-six-1-5-2">5. “resources.ContextualVersionConflict (six 1.5.2)…”</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="transit_running.html">Running TRANSIT</a><ul>
<li class="toctree-l2"><a class="reference internal" href="transit_running.html#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_running.html#command-line-mode">Command line Mode</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="input_files.html">Input Files for Transit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="input_files.html#combined-wig-files">Combined_wig Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="input_files.html#samples-metadata-file">Samples Metadata File</a></li>
<li class="toctree-l2"><a class="reference internal" href="input_files.html#genome-annotations-prot-tables-and-gff-files">Genome Annotations (.prot_tables and .gff files)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quality_control.html">Quality Control</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quality_control.html#qc-metrics-table">QC Metrics Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="quality_control.html#qc-plots">QC Plots</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quality_control.html#figure-1-read-count-distribution">Figure 1: Read-Count Distribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="quality_control.html#figure-2-qq-plot-of-read-counts-vs-geometric-distribution">Figure 2: QQ-Plot of Read-Counts vs Geometric Distribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="quality_control.html#figure-3-ranked-plot-of-read-counts">Figure 3: Ranked plot of Read-Counts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quality_control.html#interpretation-of-data-quality">Interpretation of Data Quality</a></li>
<li class="toctree-l2"><a class="reference internal" href="quality_control.html#what-to-do-about-skewed-samples">What to do about Skewed Samples?</a></li>
<li class="toctree-l2"><a class="reference internal" href="quality_control.html#beta-geometric-correction">Beta-Geometric Correction</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PRE-PROCESSING</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tnseq_stats_method.html">tnseq_stats</a></li>
<li class="toctree-l1"><a class="reference internal" href="scatterplot_method.html">Scatterplot</a><ul>
<li class="toctree-l2"><a class="reference internal" href="scatterplot_method.html#command-line-usage">Command Line Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="scatterplot_method.html#example-usage">Example Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="scatterplot_method.html#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="scatterplot_method.html#runtime">Runtime</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="corrplot_method.html">Corrplot</a><ul>
<li class="toctree-l2"><a class="reference internal" href="corrplot_method.html#command-line-usage">Command Line Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="corrplot_method.html#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="corrplot_method.html#runtime">Runtime</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="normalize_method.html">Normalization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="normalize_method.html#command-line">Command-line</a></li>
<li class="toctree-l2"><a class="reference internal" href="normalize_method.html#gui">GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="normalize_method.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gene_means_method.html">Gene Means</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ANALYSES of single conditions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gumbel_method.html">Gumbel</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gumbel_method.html#how-does-it-work">How does it work?</a></li>
<li class="toctree-l2"><a class="reference internal" href="gumbel_method.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="gumbel_method.html#parameters">Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="gumbel_method.html#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="gumbel_method.html#outputs-and-diagnostics">Outputs and diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="gumbel_method.html#run-time">Run-time</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hmm_method.html">HMM</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hmm_method.html#how-does-it-work">How does it work?</a></li>
<li class="toctree-l2"><a class="reference internal" href="hmm_method.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="hmm_method.html#parameters">Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="hmm_method.html#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="hmm_method.html#output-and-diagnostics">Output and Diagnostics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hmm_method.html#sites-output-file">Sites Output File:</a></li>
<li class="toctree-l3"><a class="reference internal" href="hmm_method.html#genes-output-file">Genes Output File:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hmm_method.html#run-time">Run-time</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ttnfitness_method.html">TTN-Fitness</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ttnfitness_method.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="ttnfitness_method.html#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="ttnfitness_method.html#volcano-plot">Volcano Plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="ttnfitness_method.html#output">Output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ttnfitness_method.html#genes-output-file">Genes Output File:</a></li>
<li class="toctree-l3"><a class="reference internal" href="ttnfitness_method.html#sites-output-file">Sites Output File:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ttnfitness_method.html#example-of-running-the-ttn-fitness-methodology-on-the-sample-glycerol-data">Example of running the TTN-Fitness methodology on the sample glycerol data</a></li>
<li class="toctree-l2"><a class="reference internal" href="ttnfitness_method.html#run-time">Run-time</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ANALYSES for pairwise comparisons</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="resampling_method.html">Resampling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="resampling_method.html#how-does-it-work">How does it work?</a></li>
<li class="toctree-l2"><a class="reference internal" href="resampling_method.html#site-restricted-s-r-resampling">Site-Restricted (S-R) Resampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="resampling_method.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="resampling_method.html#parameters">Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="resampling_method.html#notes">Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="resampling_method.html#command-line-examples">Command Line Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="resampling_method.html#doing-resampling-with-datasets-from-different-libraries">Doing resampling with datasets from different libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="resampling_method.html#doing-resampling-between-different-strains">Doing resampling between different strains</a></li>
<li class="toctree-l2"><a class="reference internal" href="resampling_method.html#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="resampling_method.html#output-and-diagnostics">Output and Diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="resampling_method.html#run-time">Run-time</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utest_method.html">Mann-Whitney U-test (utest)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="utest_method.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="utest_method.html#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="utest_method.html#output">Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="utest_method.html#runtime">Runtime</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ANALYSES for multiple conditions</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="gi_method.html">Genetic Interactions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gi_method.html#how-does-it-work">How does it work?</a></li>
<li class="toctree-l2"><a class="reference internal" href="gi_method.html#statistical-significance">Statistical Significance</a></li>
<li class="toctree-l2"><a class="reference internal" href="gi_method.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="gi_method.html#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="gi_method.html#parameters">Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="gi_method.html#gui-mode">Gui Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="gi_method.html#output-and-diagnostics">Output and Diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="gi_method.html#run-time">Run-time</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="anova_method.html">ANOVA</a><ul>
<li class="toctree-l2"><a class="reference internal" href="anova_method.html#how-does-it-work">How does it work?</a></li>
<li class="toctree-l2"><a class="reference internal" href="anova_method.html#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="anova_method.html#input-files">Input files</a></li>
<li class="toctree-l2"><a class="reference internal" href="anova_method.html#parameters">Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="anova_method.html#output-and-diagnostics">Output and Diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="anova_method.html#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="anova_method.html#run-time">Run-time</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">ZINB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-does-it-work">How does it work?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#input-files">Input files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#covariates-and-interactions">Covariates and Interactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#categorical-vs-numeric-covariates">Categorical vs Numeric Covariates</a></li>
<li class="toctree-l2"><a class="reference internal" href="#statistical-significance-what-the-p-values-mean-in-the-zinb-output">Statistical Significance - What the P-values Mean in the ZINB Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="#output-and-diagnostics">Output and Diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-time">Run-time</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">POST-PROCESSING</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pathway_enrichment_method.html">Pathway Enrichment Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pathway_enrichment_method.html#command-line-usage">Command Line Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="pathway_enrichment_method.html#parameters">Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="pathway_enrichment_method.html#auxilliary-pathway-files-in-transit-data-directory">Auxilliary Pathway Files in Transit Data Directory</a></li>
<li class="toctree-l2"><a class="reference internal" href="pathway_enrichment_method.html#current-recommendations">Current Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="pathway_enrichment_method.html#examples">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="pathway_enrichment_method.html#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="pathway_enrichment_method.html#output-and-diagnostics">Output and Diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="pathway_enrichment_method.html#run-time">Run-time</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="heatmap_method.html">Heatmap</a><ul>
<li class="toctree-l2"><a class="reference internal" href="heatmap_method.html#command-line-usage">Command Line Usage:</a></li>
<li class="toctree-l2"><a class="reference internal" href="heatmap_method.html#gui">GUI:</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TPP Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tpp.html">TPP Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="tpp.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tpp.html#running-tpp">Running TPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="tpp.html#mapping-to-genomes-with-multiple-contigs">Mapping to Genomes with Multiple Contigs</a></li>
<li class="toctree-l1"><a class="reference internal" href="tpp.html#overview-of-data-processing-procedure">Overview of Data Processing Procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="tpp.html#statistics">Statistics</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Code Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="transit.html">transit package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="transit.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit.html#pytransit-norm-tools-module">pytransit.norm_tools module</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit.html#pytransit-stat-tools-module">pytransit.stat_tools module</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit.html#pytransit-tnseq-tools-module">pytransit.tnseq_tools module</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit.html#pytransit-transit-tools-module">pytransit.transit_tools module</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit.html#module-pytransit">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TRANSIT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>ZINB</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/zinb_method.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="zinb">
<span id="id1"></span><h1>ZINB<a class="headerlink" href="#zinb" title="Permalink to this headline">¶</a></h1>
<p>The ZINB (Zero-Inflated Negative Binomial) method is used to determine
which genes exhibit <em>statistically significant variability across multiple
conditions</em>, in either the magnitude of insertion counts or local saturation, agnostically (in any one condition compared to the others).
Like <a class="reference internal" href="anova_method.html#anova"><span class="std std-ref">ANOVA</span></a>, the ZINB method takes a
<em>combined_wig</em> file (which combines multiple datasets in one file) and
a <em>samples_metadata</em> file (which describes which samples/replicates
belong to which experimental conditions).</p>
<p>ZINB can be applied to two or more conditions at a time.  Thus it
subsumes <a class="reference internal" href="resampling_method.html#resampling"><span class="std std-ref">resampling</span></a>.  Our testing suggests that
ZINB typically identifies 10-20% more varying genes than resampling
(and vastly out-performs ANOVA for detecting significant variability
across conditions).  Furthermore, because of how ZINB treats magnitude
of read counts separately from local saturation in a gene, it
occasionally identifies genes with variability not detectable by
resampling analysis.</p>
<p>Note: ZINB analysis requires R (statistical analysis software)
to be installed on your system, along with the ‘pscl’ R package.
See <a class="reference internal" href="transit_install.html#install-zinb"><span class="std std-ref">Installation Instructions</span></a>.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="how-does-it-work">
<h2>How does it work?<a class="headerlink" href="#how-does-it-work" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">For a formal description of how this method works, see our paper <a class="reference internal" href="transit_overview.html#zinb" id="id2"><span>[ZINB]</span></a>:</div>
<div class="line"><br /></div>
<div class="line-block">
<div class="line">Subramaniyam S, DeJesus MA, Zaveri A, Smith CM, Baker RE, Ehrt S, Schnappinger D, Sassetti CM, Ioerger TR. (2019).  <a class="reference external" href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-019-3156-z">Statistical analysis of variability in TnSeq data across conditions using Zero-Inflated Negative Binomial regression.</a>, <em>BMC Bioinformatics</em>. 2019 Nov 21;20(1):603. doi: 10.1186/s12859-019-3156-z.</div>
</div>
</div>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python3</span> <span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">zinb</span> <span class="o">&lt;</span><span class="n">combined</span> <span class="n">wig</span> <span class="n">file</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">samples_metadata</span> <span class="n">file</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">annotation</span> <span class="o">.</span><span class="n">prot_table</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">output</span> <span class="n">file</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">Optional</span> <span class="n">Arguments</span><span class="p">]</span>
      <span class="n">Optional</span> <span class="n">Arguments</span><span class="p">:</span>
      <span class="o">--</span><span class="n">exclude</span><span class="o">-</span><span class="n">conditions</span> <span class="o">&lt;</span><span class="n">cond1</span><span class="p">,</span><span class="n">cond2</span><span class="o">&gt;</span> <span class="o">:=</span>  <span class="n">Comma</span> <span class="n">separated</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">conditions</span> <span class="n">to</span> <span class="n">exclude</span><span class="p">,</span> <span class="k">for</span> <span class="n">the</span> <span class="n">analysis</span><span class="o">.</span>
      <span class="o">--</span><span class="n">include</span><span class="o">-</span><span class="n">conditions</span> <span class="o">&lt;</span><span class="n">cond1</span><span class="p">,</span><span class="n">cond2</span><span class="o">&gt;</span> <span class="o">:=</span>  <span class="n">Comma</span> <span class="n">separated</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">conditions</span> <span class="n">to</span> <span class="n">include</span><span class="p">,</span> <span class="k">for</span> <span class="n">the</span> <span class="n">analysis</span><span class="o">.</span> <span class="n">Conditions</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">this</span> <span class="nb">list</span><span class="p">,</span> <span class="n">will</span> <span class="n">be</span> <span class="n">excluded</span><span class="o">.</span>
      <span class="o">--</span><span class="n">n</span>   <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span>                    <span class="o">:=</span>  <span class="n">Normalization</span> <span class="n">method</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">--</span><span class="n">n</span> <span class="n">TTR</span>
      <span class="o">--</span><span class="n">ref</span> <span class="o">&lt;</span><span class="n">cond</span><span class="o">&gt;</span>                      <span class="o">:=</span> <span class="n">which</span> <span class="n">condition</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">to</span> <span class="n">use</span> <span class="k">as</span> <span class="n">a</span> <span class="n">reference</span> <span class="k">for</span> <span class="n">calculating</span> <span class="n">log_fold_changes</span> <span class="p">(</span><span class="n">comma</span><span class="o">-</span><span class="n">separated</span> <span class="k">if</span> <span class="n">multiple</span> <span class="n">conditions</span><span class="p">)</span>
      <span class="o">--</span><span class="n">iN</span>  <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>                     <span class="o">:=</span> <span class="n">Ignore</span> <span class="n">TAs</span> <span class="n">occurring</span> <span class="n">within</span> <span class="n">given</span> <span class="n">percentage</span> <span class="p">(</span><span class="k">as</span> <span class="n">integer</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">N</span> <span class="n">terminus</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">--</span><span class="n">iN</span> <span class="mi">5</span>
      <span class="o">--</span><span class="n">iC</span>  <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>                     <span class="o">:=</span> <span class="n">Ignore</span> <span class="n">TAs</span> <span class="n">occurring</span> <span class="n">within</span> <span class="n">given</span> <span class="n">percentage</span> <span class="p">(</span><span class="k">as</span> <span class="n">integer</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">C</span> <span class="n">terminus</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">--</span><span class="n">iC</span> <span class="mi">5</span>
      <span class="o">--</span><span class="n">PC</span>  <span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span>                         <span class="o">:=</span> <span class="n">pseudocounts</span> <span class="n">to</span> <span class="n">use</span> <span class="k">for</span> <span class="n">calculating</span> <span class="n">log_fold_changes</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">--</span><span class="n">PC</span> <span class="mi">5</span>
      <span class="o">-</span><span class="n">winz</span>                             <span class="o">:=</span> <span class="n">winsorize</span> <span class="n">insertion</span> <span class="n">counts</span> <span class="k">for</span> <span class="n">each</span> <span class="n">gene</span> <span class="ow">in</span> <span class="n">each</span> <span class="n">condition</span> <span class="p">(</span><span class="n">replace</span> <span class="nb">max</span> <span class="n">cnt</span> <span class="k">with</span> <span class="mi">2</span><span class="n">nd</span> <span class="n">highest</span><span class="p">;</span> <span class="n">helps</span> <span class="n">mitigate</span> <span class="n">effect</span> <span class="n">of</span> <span class="n">outliers</span><span class="p">)</span>
      <span class="o">--</span><span class="n">group</span><span class="o">-</span><span class="n">by</span>  <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span>              <span class="o">:=</span> <span class="n">columnname</span> <span class="p">(</span><span class="ow">in</span> <span class="n">samples_metadata</span><span class="p">)</span> <span class="n">to</span> <span class="n">use</span> <span class="k">as</span> <span class="n">the</span> <span class="n">Condition</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="s2">&quot;Condition&quot;</span>
      <span class="o">--</span><span class="n">condition</span> <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span>              <span class="o">:=</span> <span class="n">alias</span> <span class="k">for</span> <span class="o">--</span><span class="n">group</span><span class="o">-</span><span class="n">by</span>
      <span class="o">--</span><span class="n">covars</span> <span class="o">&lt;</span><span class="n">covar1</span><span class="p">,</span><span class="n">covar2</span><span class="o">...&gt;</span>       <span class="o">:=</span> <span class="n">Comma</span> <span class="n">separated</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">covariates</span> <span class="p">(</span><span class="ow">in</span> <span class="n">metadata</span> <span class="n">file</span><span class="p">)</span> <span class="n">to</span> <span class="n">include</span><span class="p">,</span> <span class="k">for</span> <span class="n">the</span> <span class="n">analysis</span><span class="o">.</span>
      <span class="o">--</span><span class="n">interactions</span> <span class="o">&lt;</span><span class="n">covar1</span><span class="p">,</span><span class="n">covar2</span><span class="o">...&gt;</span> <span class="o">:=</span> <span class="n">Comma</span> <span class="n">separated</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">covariates</span> <span class="n">to</span> <span class="n">include</span><span class="p">,</span> <span class="n">that</span> <span class="n">interact</span> <span class="k">with</span> <span class="n">the</span> <span class="n">condition</span> <span class="k">for</span> <span class="n">the</span> <span class="n">analysis</span><span class="o">.</span> <span class="n">Must</span> <span class="n">be</span> <span class="n">factors</span>
      <span class="o">--</span><span class="n">gene</span> <span class="o">&lt;</span><span class="n">RV</span> <span class="n">number</span> <span class="ow">or</span> <span class="n">Gene</span> <span class="n">name</span><span class="o">&gt;</span>   <span class="o">:=</span> <span class="n">Run</span> <span class="n">method</span> <span class="k">for</span> <span class="n">one</span> <span class="n">gene</span> <span class="ow">and</span> <span class="nb">print</span> <span class="n">model</span> <span class="n">output</span><span class="o">.</span>
      <span class="o">-</span><span class="n">append_gene_desc</span>                 <span class="o">:=</span> <span class="n">the</span> <span class="n">output_file</span> <span class="n">will</span> <span class="n">have</span> <span class="n">column</span> <span class="k">for</span> <span class="n">gene</span> <span class="n">descriptions</span>
</pre></div>
</div>
</div>
<div class="section" id="input-files">
<h2>Input files<a class="headerlink" href="#input-files" title="Permalink to this headline">¶</a></h2>
<p>For description of input file formats, see documentation
on <a class="reference internal" href="input_files.html#combined-wig-link"><span class="std std-ref">Combined wig files</span></a>
and <a class="reference internal" href="input_files.html#metadata-files"><span class="std std-ref">Metadata files</span></a>.</p>
</div>
<div class="section" id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h2>
<p>The following parameters are available for the ZINB method:</p>
<ul class="simple">
<li><p><strong>--include-conditions &lt;cond1,…&gt;:</strong> Includes the given set of conditions from the ZINB test. Conditions not in this list are ignored. Note: this is useful for specifying the order in which the columns are listed in the output file.</p></li>
<li><p><strong>--exclude-conditions &lt;cond1,…&gt;:</strong> Ignores the given set of conditions from the ZINB test.</p></li>
<li><p><strong>--ref &lt;cond&gt;:</strong> which condition to use as a reference when computing LFCs in the output file. By default, LFCs for each condition are computed relative to the grandmean across all condintions.</p></li>
<li><p><strong>--n &lt;TTR|betageom|nonorm…&gt;:</strong> Determines which Normalization method to
use when comparing datasets (Default: --n TTR). Proper normalization is important as it
ensures that other sources of variability are not mistakenly treated
as real differences. See the <a class="reference internal" href="normalize_method.html#normalization"><span class="std std-ref">Normalization</span></a> section for a description
of normalization method available in TRANSIT.</p></li>
<li><p><strong>--condition &lt;covar&gt;:</strong> column name (in samples_metadata) to use as the primary Condition being evaluated (to test for significant variability of insertions among conditions). Default: “Condition” (column name in metadata)</p></li>
<li><p><strong>--covars &lt;covar1,…&gt;:</strong> Comma separated list of covariates (columns in metadata file) to include, for the analysis.  If additional covariates distinguishing the samples are available, such as library, timepoint, or genotype, they may be “factored out” of the test of the primary condition. (variation due to covars is accounted for in the model, but not considered in evaluating the effect on variability due to the primary condition)</p></li>
<li><p><strong>--interactions &lt;covar1,…&gt;:</strong> Comma separated list of covariates (cols in metadata) to include, that interact with the condition for the analysis. (variation due to these variables <em>is</em> included in testing the effect of the main condition)</p></li>
<li><p><strong>--PC &lt;N&gt;:</strong> Pseudocounts used in calculating LFCs in output file. (Default: --PC 5)</p></li>
<li><p><strong>-winz</strong>: <a class="reference external" href="https://en.wikipedia.org/wiki/Winsorizing">winsorize</a> insertion counts for each gene in each condition.
Replace max count in each gene with 2nd highest.  This can help mitigate effect of outliers.</p></li>
</ul>
</div>
<div class="section" id="covariates-and-interactions">
<h2>Covariates and Interactions<a class="headerlink" href="#covariates-and-interactions" title="Permalink to this headline">¶</a></h2>
<p>While ZINB is focus on identifying variability of insertion counts across conditions,
the linear model also allows you to take other variables into account.
There are two types of auxilliary variables: <em>covariates</em> and <em>interactions</em>. These can be provided as extra columns in the samples metadata file.
Covariates are attributes of the individual samples that could have a systematic
effect on the insertion counts which we would like to account for and subsequently ignore
(like nuissance variables). Examples include things like batch or library.</p>
<p>Interactions are extra variables for which we want to test their effect on the
main variable (or condition).  For example, suppose we collect TnSeq data at several
different timepoints (e.g. length of incubation or infection).  If we just test
time as the condition, we will be identifying genes that vary over time (if timepoints
are numeric, think of the model as fitting a ‘slope’ to the counts).
But suppose we have data for both a wild-type and knock-out strain.  Then we might be
interested in genes for which the time-dependent behavior <em>differs</em> between the two
strains (think: different ‘slopes’). In such a case, we would say strain and time interact.</p>
<p>If covariates distinguishing the samples are available,
such as batch or library (factors that could influence counts, but which
we don’t care about so we want to factor out these effects), they may be
incorporated in the ZINB model by using the <strong>--covars</strong> flag and samples
metadata file. For example, consider the following samples metadata
file, with a column describing the batch information of each
replicate.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ID</span>      <span class="n">Condition</span>    <span class="n">Filename</span>                                     <span class="n">Batch</span>
<span class="n">glyc1</span>   <span class="n">glycerol</span>     <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">example_data</span><span class="o">/</span><span class="n">glycerol_rep1</span><span class="o">.</span><span class="n">wig</span>        <span class="n">B1</span>
<span class="n">glyc2</span>   <span class="n">glycerol</span>     <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">example_data</span><span class="o">/</span><span class="n">glycerol_rep2</span><span class="o">.</span><span class="n">wig</span>        <span class="n">B2</span>
<span class="n">chol1</span>   <span class="n">cholesterol</span>  <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">example_data</span><span class="o">/</span><span class="n">cholesterol_rep1</span><span class="o">.</span><span class="n">wig</span>     <span class="n">B1</span>
<span class="n">chol2</span>   <span class="n">cholesterol</span>  <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">example_data</span><span class="o">/</span><span class="n">cholesterol_rep2</span><span class="o">.</span><span class="n">wig</span>     <span class="n">B2</span>
<span class="n">chol2</span>   <span class="n">cholesterol</span>  <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">example_data</span><span class="o">/</span><span class="n">cholesterol_rep3</span><span class="o">.</span><span class="n">wig</span>     <span class="n">B2</span>
</pre></div>
</div>
<p>This information can be included to eliminate variability due to batch by using
the <strong>--covars</strong> flag.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python3</span> <span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">zinb</span> <span class="n">combined</span><span class="o">.</span><span class="n">wig</span> <span class="n">samples</span><span class="o">.</span><span class="n">metadata</span> <span class="n">prot</span><span class="o">.</span><span class="n">table</span> <span class="n">output</span><span class="o">.</span><span class="n">file</span> <span class="o">--</span><span class="n">covars</span> <span class="n">Batch</span>
</pre></div>
</div>
<p>Similarly, an interaction variable may be included in the model.
This is specified by the user with the <strong>--interactions</strong> flag,
followed by the name of a column in the samples metadata to test as the interaction
with the condition. If there are multiple interactions, they may be given as a comma-separated list.</p>
<p>To give an example,
consider an experiment where the condition represents
a treatment (e.g. with values ‘treated’ and ‘control’), and we have another column
called Strain (with values ‘wild-type’ and ‘mutant’).
If we want to test whether the effect of the treatment (versus control)
differs depending on the strain, we could do this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python3</span> <span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">zinb</span> <span class="n">combined</span><span class="o">.</span><span class="n">wig</span> <span class="n">samples</span><span class="o">.</span><span class="n">metadata</span> <span class="n">prot</span><span class="o">.</span><span class="n">table</span> <span class="n">output</span><span class="o">.</span><span class="n">file</span> <span class="o">--</span><span class="n">interactions</span> <span class="n">Strain</span>
</pre></div>
</div>
<p>In this case, the condition is implicitly assumed to be the column in the samples metadata file
labeled ‘Condition’.  If you want to specify a different column to use as the primary condition to
test (for example, if Treatment were a distinct column), you can use the <strong>--condition</strong> flag:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python3</span> <span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">zinb</span> <span class="n">combined</span><span class="o">.</span><span class="n">wig</span> <span class="n">samples</span><span class="o">.</span><span class="n">metadata</span> <span class="n">prot</span><span class="o">.</span><span class="n">table</span> <span class="n">output</span><span class="o">.</span><span class="n">file</span> <span class="o">--</span><span class="n">condition</span> <span class="n">Treatment</span> <span class="o">--</span><span class="n">interactions</span> <span class="n">Strain</span>
</pre></div>
</div>
<p>The difference between how covariates and interactions are handeled in the model
is discussed below in the section on Statistical Significance.</p>
</div>
<div class="section" id="categorical-vs-numeric-covariates">
<h2>Categorical vs Numeric Covariates<a class="headerlink" href="#categorical-vs-numeric-covariates" title="Permalink to this headline">¶</a></h2>
<p>In some cases, covariates are intended to be treated as categorical
variables, like ‘batch’ or ‘library’ or ‘medium’.
In other cases, a covariate might be a numeric value, such as
‘time’ or ‘concentration’, in which the ordering of values is
relevant.  The ZINB implementation tries to guess the type of each covariate.
If they are strings, they are treated as discrete factors (each with
their own distinct parameter).  If the given covariate can
be parsed as numbers, the model interprets them as real values.  In this
case, the covariate is treated as a linear factor (regressor), and is
incorporated in the model as a single coefficient, capturing the slope or
trend in the insertion counts as the covariate value increases.</p>
</div>
<div class="section" id="statistical-significance-what-the-p-values-mean-in-the-zinb-output">
<h2>Statistical Significance - What the P-values Mean in the ZINB Output<a class="headerlink" href="#statistical-significance-what-the-p-values-mean-in-the-zinb-output" title="Permalink to this headline">¶</a></h2>
<p>Formally, the P-value is from a likelihood ratio test (LRT) between a
condition-dependent ZINB model (<span class="math notranslate nohighlight">\(m_1\)</span>) and a
condition-independent (null) ZINB model (<span class="math notranslate nohighlight">\(m_0\)</span>).</p>
<div class="math notranslate nohighlight">
\[2 \ ln \frac{L(m_1)}{L(m_0)} \sim \chi^2_{df}\]</div>
<p>where L(.) is the ZINB likelihood function, and <span class="math notranslate nohighlight">\(\chi^2_{df}\)</span> is
the chi-squared distribution with degrees of freedom (df) equal to
difference in the number of parameters bewteen the two models.  The p-value is
calculated based on this distribution.</p>
<p>In a simple case where variability across a set of conditions X is being tested,
you can think of the model approximately as:</p>
<div class="math notranslate nohighlight">
\[m_1: ln \ \mu = \alpha_0+\vec\alpha X\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu\)</span> is an estimate of the mean (non-zero) insertion
count in a gene (a parameter in the likelihood function for ZINB),
<span class="math notranslate nohighlight">\(\alpha_0\)</span> is a constant (the mean across all
conditions), and <span class="math notranslate nohighlight">\(\vec\alpha\)</span> is a vector of coefficients
representing the deviation of the mean count in each condition.
(There is a corresponding equation for estimating the saturation as a
function of condition.)</p>
<p>To evaluate whether the variability across conditions is significant, we
compare to a null model, where the counts are estimated by the global mean only
(dropping the condition variable X).</p>
<div class="math notranslate nohighlight">
\[m_0: ln \ \mu = \alpha_0\]</div>
<p>When a covariate C is available, it is incorporated in both models (additively),
to account for the effect of the covariate in <span class="math notranslate nohighlight">\(m_1\)</span>. Coefficients in <span class="math notranslate nohighlight">\(\vec\beta\)</span>
represent systematic effects on the mean count due to the covariate, and effectively
get subtracted out of the condition coefficients, but <span class="math notranslate nohighlight">\(\vec\beta\)</span> is also
included in the null model <span class="math notranslate nohighlight">\(m_0\)</span>, since we want to discount the effect of C on the
likelihood and focus on evaluting the effect of X.</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}m_1: ln \ \mu = \alpha_0 + \vec\alpha X + \vec\beta C\\m_0: ln \ \mu = \alpha_0 + \vec\beta C\end{aligned}\end{align} \]</div>
<p>When an interaction I is being tested, it is incorporated <em>multiplicatively</em> in
the main model <span class="math notranslate nohighlight">\(m_1\)</span> and <em>additively</em> in the null model <span class="math notranslate nohighlight">\(m_0\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}m_1: ln \ \mu = \alpha_0 + \vec\alpha X + \vec\beta I + \vec\gamma X*I\\m_0: ln \ \mu = \alpha_0 + \vec\alpha X + \vec\beta I\end{aligned}\end{align} \]</div>
<p>The meaning of this is that the coefficients <span class="math notranslate nohighlight">\(\vec\alpha\)</span> and
<span class="math notranslate nohighlight">\(\vec\beta\)</span> capture the additive effects of how the mean
insertion count in a gene depends on the condition variable and the
interaction variable, respectively, and the X*I term captures
additional (non-additive) deviations (which is the traditional way
interactions are handled in generalized linear models, GLMs).  Thus,
if there were no interaction, one would expect the mean in datasets
representing the <em>combination</em> of X and I to be predicted by the
offsets for each independently.  To the extend that this is not the
case, we say that X and I interaction, and the coefficients
<span class="math notranslate nohighlight">\(\gamma\)</span> for X*I capture these deviations (non-additive
effects).</p>
<p>For example, think of condition X as Strain (e.g. wild-type vs mutant),
and interaction I as Treatment (e.g. treated versus control).
Then the main model would look like this:</p>
<div class="math notranslate nohighlight">
\[m_1: ln \ \mu = \alpha_0 + \alpha_1 WT  + \alpha_2 mutant + \beta_1 control + \beta_2 treated + \gamma mutant * treated\]</div>
<p>and this would be compared to the following null model (without the interaction term):</p>
<div class="math notranslate nohighlight">
\[m_0: ln \ \mu = \alpha_0 + \alpha_1 WT  + \alpha_2 mutant + \beta_1 control + \beta_2 treated\]</div>
</div>
<div class="section" id="gui-mode">
<h2>GUI Mode<a class="headerlink" href="#gui-mode" title="Permalink to this headline">¶</a></h2>
<dl>
<dt>ZINB can be access though the “Method” tab in the Menu Bar.</dt><dd><a class="reference internal image-reference" href="_images/zinb_selection_gui.png"><img alt="_images/zinb_selection_gui.png" class="align-center" src="_images/zinb_selection_gui.png" style="width: 1000px;" /></a>
</dd>
</dl>
<p>The parameters to input through the parameter panel for the method is equivalent to the command line usage, except
in the GUI format we name the output files using the prefix passed in.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/zinb_parameter_panel.png"><img alt="_images/zinb_parameter_panel.png" class="align-center" src="_images/zinb_parameter_panel.png" style="width: 1000px;" /></a>
</div></blockquote>
</div>
<div class="section" id="output-and-diagnostics">
<h2>Output and Diagnostics<a class="headerlink" href="#output-and-diagnostics" title="Permalink to this headline">¶</a></h2>
<p>The ZINB method outputs a tab-delimited file with results for each
gene in the genome. P-values are adjusted for multiple comparisons using
the Benjamini-Hochberg procedure (called “q-values” or “p-adj.”). A
typical threshold for conditional essentiality on is q-value &lt; 0.05.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 28%" />
<col style="width: 72%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column Header</p></th>
<th class="head"><p>Column Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Rv</p></td>
<td><p>Gene ID.</p></td>
</tr>
<tr class="row-odd"><td><p>Gene</p></td>
<td><p>Name of the gene.</p></td>
</tr>
<tr class="row-even"><td><p>TA Sites</p></td>
<td><p>Number of TA sites in Gene</p></td>
</tr>
<tr class="row-odd"><td><p>Means…</p></td>
<td><p>Mean read-counts for each condition</p></td>
</tr>
<tr class="row-even"><td><p>Log 2 FCs…</p></td>
<td><p>Log-fold-change (base 2) of mean insertion count relative to
mean across all conditions. Pseudo-counts of 5 are added.
If only 2 conditions, LFC is based on ratio of second to first.</p></td>
</tr>
<tr class="row-odd"><td><p>Non Zero means…</p></td>
<td><p>Mean read-counts at non-zero zites for each condition</p></td>
</tr>
<tr class="row-even"><td><p>Non Zero percentages…</p></td>
<td><p>Saturation (percentage of non-zero sites) for each condition</p></td>
</tr>
<tr class="row-odd"><td><p>P Value</p></td>
<td><p>P-value calculated by the ZINB test.</p></td>
</tr>
<tr class="row-even"><td><p>Adj P Value</p></td>
<td><p>Adjusted p-value controlling for the FDR (Benjamini-Hochberg)</p></td>
</tr>
<tr class="row-odd"><td><p>Status</p></td>
<td><p>Diagnostic information (explanation for genes not analyzed)</p></td>
</tr>
<tr class="row-even"><td><p>Gene Annotation</p></td>
<td><p>Annotation of the gene following the annotation file passed in</p></td>
</tr>
</tbody>
</table>
<p><strong>Log 2 FC</strong> (log-fold-changes):
For each condition, the LFC is calculated as the log-base-2 of the
ratio of mean insertion count in that condition <strong>relative to the
mean of means across all the conditions</strong> (by default).
However, you can change this by desginating a specific reference condition using the flag <strong>--ref</strong>.
(If there are multiple reference conditions, they may be given as a comma separated list.)
(If you are using interactions, it is more complicated to specify a reference condition by name because they have to include the interactions, e.g. as shown in the column headers in the output file.)
Pseudocount are incorporated to reduce the impact of noise on LFCs, based on the formula below.
The pseudocounts can be adjusted using the -PC flag.
Changing the pseudocounts (via -PC) can reduce the artifactual appearance of genes with
high-magnitude LFCs but that have small overall counts (which are susceptible to noise).
Changing the pseudocounts will not affect the analysis of statistical significance and hence number of varying genes, however.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LFC</span> <span class="o">=</span> <span class="n">log2</span><span class="p">((</span><span class="n">mean_insertions_in_condition</span> <span class="o">+</span> <span class="n">PC</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mean_of_means_across_all_conditions</span> <span class="o">+</span> <span class="n">PC</span><span class="p">))</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="run-time">
<h2>Run-time<a class="headerlink" href="#run-time" title="Permalink to this headline">¶</a></h2>
<p>A typical run of the ZINB method takes ~5 minutes to analze a combined wig
file with 6 conditions, 3 replicates per condition. It will, of
course, run more slowly if you have many more conditions.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="transit-sectionend docutils" />
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="pathway_enrichment_method.html" class="btn btn-neutral float-right" title="Pathway Enrichment Analysis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="anova_method.html" class="btn btn-neutral float-left" title="ANOVA" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2015, Michael A. DeJesus &amp; Thomas R. Ioerger.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
   

</body>
</html>