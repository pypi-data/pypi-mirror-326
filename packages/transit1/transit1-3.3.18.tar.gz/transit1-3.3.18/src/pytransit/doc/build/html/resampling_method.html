

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Resampling &mdash; TRANSIT v4.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/default.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Mann-Whitney U-test (utest)" href="utest_method.html" />
    <link rel="prev" title="TTN-Fitness" href="ttnfitness_method.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> TRANSIT
          

          
            
            <img src="_static/transit_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                v4.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">TRANSIT MANUAL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="transit_overview.html">TRANSIT Overview (4.0)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#typical-workflow">Typical Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#tpp-transit-pre-processor">TPP (Transit Pre-Processor)</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#combined-wig-and-metadata-files">Combined_wig and Metadata Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#genome-annotations-prot-tables-and-gff-files">Genome Annotations (.prot_tables and .gff files)</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#gui">GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#pre-processing-tasks">Pre-Processing Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#statistical-analysis-methods">Statistical Analysis Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#analyses-for-tn5-datasets">Analyses for Tn5 Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#results-and-post-processing">Results and Post-Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#command-line">Command Line</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#developers">Developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_overview.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="transit_install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="transit_install.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_install.html#python-3">Python 3:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="transit_install.html#additional-requirements-r-statistical-analysis-package">Additional Requirements: R (statistical analysis package)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="transit_install.html#optional-install-bwa-to-use-with-tpp-pre-processor">Optional: Install BWA to use with TPP pre-processor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="transit_install.html#linux-osx-instructions">Linux &amp; OSX Instructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="transit_install.html#windows-instructions">Windows Instructions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="transit_install.html#upgrading">Upgrading</a><ul>
<li class="toctree-l3"><a class="reference internal" href="transit_install.html#method-1-upgrading-package-installation">Method 1: Upgrading package installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="transit_install.html#method-2-upgrading-source-installation">Method 2: Upgrading source installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="transit_install.html#installing-wxpython">Installing wxPython</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_install.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="transit_install.html#no-window-appears-when-running-in-gui-mode">1. No window appears when running in GUI mode.</a></li>
<li class="toctree-l3"><a class="reference internal" href="transit_install.html#pip3-systemerror-cannot-compile-python-h">2. pip3: SystemError: Cannot compile ‘Python.h’.</a></li>
<li class="toctree-l3"><a class="reference internal" href="transit_install.html#pip-the-following-required-packages-can-not-be-built-freetype-png-etc">3. pip: “The following required packages can not be built: freetype,png,” etc.</a></li>
<li class="toctree-l3"><a class="reference internal" href="transit_install.html#pip3-no-lapack-blas-resources-found">4. pip3: “No lapack/blas resources found”</a></li>
<li class="toctree-l3"><a class="reference internal" href="transit_install.html#resources-contextualversionconflict-six-1-5-2">5. “resources.ContextualVersionConflict (six 1.5.2)…”</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="transit_running.html">Running TRANSIT</a><ul>
<li class="toctree-l2"><a class="reference internal" href="transit_running.html#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit_running.html#command-line-mode">Command line Mode</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="input_files.html">Input Files for Transit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="input_files.html#combined-wig-files">Combined_wig Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="input_files.html#samples-metadata-file">Samples Metadata File</a></li>
<li class="toctree-l2"><a class="reference internal" href="input_files.html#genome-annotations-prot-tables-and-gff-files">Genome Annotations (.prot_tables and .gff files)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quality_control.html">Quality Control</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quality_control.html#qc-metrics-table">QC Metrics Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="quality_control.html#qc-plots">QC Plots</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quality_control.html#figure-1-read-count-distribution">Figure 1: Read-Count Distribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="quality_control.html#figure-2-qq-plot-of-read-counts-vs-geometric-distribution">Figure 2: QQ-Plot of Read-Counts vs Geometric Distribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="quality_control.html#figure-3-ranked-plot-of-read-counts">Figure 3: Ranked plot of Read-Counts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quality_control.html#interpretation-of-data-quality">Interpretation of Data Quality</a></li>
<li class="toctree-l2"><a class="reference internal" href="quality_control.html#what-to-do-about-skewed-samples">What to do about Skewed Samples?</a></li>
<li class="toctree-l2"><a class="reference internal" href="quality_control.html#beta-geometric-correction">Beta-Geometric Correction</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PRE-PROCESSING</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tnseq_stats_method.html">tnseq_stats</a></li>
<li class="toctree-l1"><a class="reference internal" href="scatterplot_method.html">Scatterplot</a><ul>
<li class="toctree-l2"><a class="reference internal" href="scatterplot_method.html#command-line-usage">Command Line Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="scatterplot_method.html#example-usage">Example Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="scatterplot_method.html#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="scatterplot_method.html#runtime">Runtime</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="corrplot_method.html">Corrplot</a><ul>
<li class="toctree-l2"><a class="reference internal" href="corrplot_method.html#command-line-usage">Command Line Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="corrplot_method.html#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="corrplot_method.html#runtime">Runtime</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="normalize_method.html">Normalization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="normalize_method.html#command-line">Command-line</a></li>
<li class="toctree-l2"><a class="reference internal" href="normalize_method.html#gui">GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="normalize_method.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gene_means_method.html">Gene Means</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ANALYSES of single conditions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gumbel_method.html">Gumbel</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gumbel_method.html#how-does-it-work">How does it work?</a></li>
<li class="toctree-l2"><a class="reference internal" href="gumbel_method.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="gumbel_method.html#parameters">Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="gumbel_method.html#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="gumbel_method.html#outputs-and-diagnostics">Outputs and diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="gumbel_method.html#run-time">Run-time</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hmm_method.html">HMM</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hmm_method.html#how-does-it-work">How does it work?</a></li>
<li class="toctree-l2"><a class="reference internal" href="hmm_method.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="hmm_method.html#parameters">Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="hmm_method.html#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="hmm_method.html#output-and-diagnostics">Output and Diagnostics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hmm_method.html#sites-output-file">Sites Output File:</a></li>
<li class="toctree-l3"><a class="reference internal" href="hmm_method.html#genes-output-file">Genes Output File:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hmm_method.html#run-time">Run-time</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ttnfitness_method.html">TTN-Fitness</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ttnfitness_method.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="ttnfitness_method.html#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="ttnfitness_method.html#volcano-plot">Volcano Plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="ttnfitness_method.html#output">Output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ttnfitness_method.html#genes-output-file">Genes Output File:</a></li>
<li class="toctree-l3"><a class="reference internal" href="ttnfitness_method.html#sites-output-file">Sites Output File:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ttnfitness_method.html#example-of-running-the-ttn-fitness-methodology-on-the-sample-glycerol-data">Example of running the TTN-Fitness methodology on the sample glycerol data</a></li>
<li class="toctree-l2"><a class="reference internal" href="ttnfitness_method.html#run-time">Run-time</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ANALYSES for pairwise comparisons</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Resampling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-does-it-work">How does it work?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#site-restricted-s-r-resampling">Site-Restricted (S-R) Resampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#notes">Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#command-line-examples">Command Line Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#doing-resampling-with-datasets-from-different-libraries">Doing resampling with datasets from different libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="#doing-resampling-between-different-strains">Doing resampling between different strains</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="#output-and-diagnostics">Output and Diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-time">Run-time</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utest_method.html">Mann-Whitney U-test (utest)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="utest_method.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="utest_method.html#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="utest_method.html#output">Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="utest_method.html#runtime">Runtime</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ANALYSES for multiple conditions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gi_method.html">Genetic Interactions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gi_method.html#how-does-it-work">How does it work?</a></li>
<li class="toctree-l2"><a class="reference internal" href="gi_method.html#statistical-significance">Statistical Significance</a></li>
<li class="toctree-l2"><a class="reference internal" href="gi_method.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="gi_method.html#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="gi_method.html#parameters">Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="gi_method.html#gui-mode">Gui Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="gi_method.html#output-and-diagnostics">Output and Diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="gi_method.html#run-time">Run-time</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="anova_method.html">ANOVA</a><ul>
<li class="toctree-l2"><a class="reference internal" href="anova_method.html#how-does-it-work">How does it work?</a></li>
<li class="toctree-l2"><a class="reference internal" href="anova_method.html#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="anova_method.html#input-files">Input files</a></li>
<li class="toctree-l2"><a class="reference internal" href="anova_method.html#parameters">Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="anova_method.html#output-and-diagnostics">Output and Diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="anova_method.html#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="anova_method.html#run-time">Run-time</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="zinb_method.html">ZINB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="zinb_method.html#how-does-it-work">How does it work?</a></li>
<li class="toctree-l2"><a class="reference internal" href="zinb_method.html#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="zinb_method.html#input-files">Input files</a></li>
<li class="toctree-l2"><a class="reference internal" href="zinb_method.html#parameters">Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="zinb_method.html#covariates-and-interactions">Covariates and Interactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="zinb_method.html#categorical-vs-numeric-covariates">Categorical vs Numeric Covariates</a></li>
<li class="toctree-l2"><a class="reference internal" href="zinb_method.html#statistical-significance-what-the-p-values-mean-in-the-zinb-output">Statistical Significance - What the P-values Mean in the ZINB Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="zinb_method.html#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="zinb_method.html#output-and-diagnostics">Output and Diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="zinb_method.html#run-time">Run-time</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">POST-PROCESSING</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pathway_enrichment_method.html">Pathway Enrichment Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pathway_enrichment_method.html#command-line-usage">Command Line Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="pathway_enrichment_method.html#parameters">Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="pathway_enrichment_method.html#auxilliary-pathway-files-in-transit-data-directory">Auxilliary Pathway Files in Transit Data Directory</a></li>
<li class="toctree-l2"><a class="reference internal" href="pathway_enrichment_method.html#current-recommendations">Current Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="pathway_enrichment_method.html#examples">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="pathway_enrichment_method.html#gui-mode">GUI Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="pathway_enrichment_method.html#output-and-diagnostics">Output and Diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="pathway_enrichment_method.html#run-time">Run-time</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="heatmap_method.html">Heatmap</a><ul>
<li class="toctree-l2"><a class="reference internal" href="heatmap_method.html#command-line-usage">Command Line Usage:</a></li>
<li class="toctree-l2"><a class="reference internal" href="heatmap_method.html#gui">GUI:</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TPP Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tpp.html">TPP Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="tpp.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tpp.html#running-tpp">Running TPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="tpp.html#mapping-to-genomes-with-multiple-contigs">Mapping to Genomes with Multiple Contigs</a></li>
<li class="toctree-l1"><a class="reference internal" href="tpp.html#overview-of-data-processing-procedure">Overview of Data Processing Procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="tpp.html#statistics">Statistics</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Code Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="transit.html">transit package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="transit.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit.html#pytransit-norm-tools-module">pytransit.norm_tools module</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit.html#pytransit-stat-tools-module">pytransit.stat_tools module</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit.html#pytransit-tnseq-tools-module">pytransit.tnseq_tools module</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit.html#pytransit-transit-tools-module">pytransit.transit_tools module</a></li>
<li class="toctree-l2"><a class="reference internal" href="transit.html#module-pytransit">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TRANSIT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Resampling</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/resampling_method.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="resampling">
<span id="id1"></span><h1>Resampling<a class="headerlink" href="#resampling" title="Permalink to this headline">¶</a></h1>
<p>The resampling method is a comparative analysis the allows that can be
used to determine conditional essentiality of genes. It is based on a
permutation test, and is capable of determining read-counts that are
significantly different across conditions.</p>
<p>See <a class="reference internal" href="pathway_enrichment_method.html#gsea"><span class="std std-ref">Pathway Enrichment Analysis</span></a> for post-processing the hits to
determine if the hits are associated with a particular functional catogory
of genes or known biological pathway.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="how-does-it-work">
<h2>How does it work?<a class="headerlink" href="#how-does-it-work" title="Permalink to this headline">¶</a></h2>
<p>This technique has yet to be formally published in the context of
differential essentiality analysis. Briefly, the read-counts at each
genes are determined for each replicate of each condition. The mean
read-count in condition A is subtracted from the mean read-count in
condition B, to obtain an observed difference in means. The TA
sites are then permuted for a given number of “samples”. For each one of
these permutations, the difference in read-counts is determined. This
forms a null distribution, from which a p-value is calculated for the
original, observed difference in read-counts.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="site-restricted-s-r-resampling">
<h2>Site-Restricted (S-R) Resampling<a class="headerlink" href="#site-restricted-s-r-resampling" title="Permalink to this headline">¶</a></h2>
<p>The original version of resampling implemented in
Transit is called ‘pooled’ resampling because the counts are permuted
among all samples (replicates, conditions) <em>and</em> among all the TA
sites in a gene (i.e. randomizing counts within and between TA sites).
This was based on the assumption that insertions at any TA site are
equally likely (and the only differences are due to stochastic
differences in abundance in the transposon insertion library when
constructed).</p>
<p>We recently developed an improved version of resampling called
“site-restricted” (S-R) resampling.  With S-R resampling, during the
process of permuting the counts to generate the null distribution, the
counts at each TA site are restricted to permutations among samples
<strong>within the same TA site</strong> (the counts at each site are permuted
independently).  This restriction has the effect of reducing the
variance in the null distribution, because there is evidence that
there is an insertion bias for the Himar1 transposon that causes some
TA sites to have a higher propensity for insertions and hence higher
insertion counts than others (<a class="reference internal" href="transit_overview.html#choudhery2021"><span class="std std-ref">Choudhery et al, 2021</span></a>).</p>
<p>Testing on a wide range of TnSeq datasets suggests
that S-R resampling is <strong>more sensitive</strong> than regular pooled resampling.
Typically, S-R resampling finds 2-3 times as many significant conditionally essential
genes, mostly including the ones found by pooled resampling, but also capturing more
borderline cases that were close to the previous significance cutoff.</p>
<p>It is important to note that the previous pooled version of resampling that has been
in Transit for many years is not wrong, just overly conservative.</p>
<p>S-R resampling is incorporated in the v3.2.7 version of Transit.
There is an option (i.e. checkbox) for it in the GUI interface
for the resampling method, and there is a new command-line flag (-sr) if you want
use it in console mode.</p>
<p>History:</p>
<ul class="simple">
<li><p>The original form of resampling in Transit (for a long time) was ‘pooled’ resampling.</p></li>
<li><p>Site-restricted resampling was introduced as an option (-sr) in v3.2.7 (9/21/22).</p></li>
<li><p>As of Transit v4.0, site-restricted resampling is now the default.</p></li>
</ul>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Usage</span> <span class="mi">1</span><span class="p">:</span>
    <span class="o">&gt;</span> <span class="n">python3</span> <span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span>  <span class="n">resampling</span> <span class="o">&lt;</span><span class="n">combined_wig_file</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">metadata_file</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">annotation_file</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">ctrl_condition</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">exp_condition</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">output_file</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">Optional</span> <span class="n">Arguments</span><span class="p">]</span>
      <span class="n">Note</span><span class="p">:</span> <span class="n">The</span> <span class="n">ctrl</span> <span class="ow">and</span> <span class="n">exp</span> <span class="n">condition</span> <span class="n">names</span> <span class="n">need</span> <span class="n">to</span> <span class="n">match</span> <span class="n">Condition</span> <span class="n">names</span> <span class="ow">in</span> <span class="n">metadata_file</span>

<span class="n">Usage</span> <span class="mi">2</span><span class="p">:</span>
    <span class="o">&gt;</span> <span class="n">python3</span> <span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span>  <span class="n">resampling</span> <span class="o">&lt;</span><span class="n">comma</span><span class="o">-</span><span class="n">separated</span> <span class="o">.</span><span class="n">wig</span> <span class="n">files</span> <span class="p">(</span><span class="n">control</span> <span class="n">group</span><span class="p">)</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">comma</span><span class="o">-</span><span class="n">separated</span> <span class="o">.</span><span class="n">wig</span> <span class="n">files</span> <span class="p">(</span><span class="n">experimental</span> <span class="n">group</span><span class="p">)</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">annotation_file</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">output_file</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">Optional</span> <span class="n">Arguments</span><span class="p">]</span>

<span class="n">Optional</span> <span class="n">Arguments</span><span class="p">:</span>
    <span class="o">--</span><span class="n">s</span> <span class="o">&lt;</span><span class="n">integer</span><span class="o">&gt;</span>        <span class="o">:=</span>  <span class="n">Number</span> <span class="n">of</span> <span class="n">samples</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">--</span><span class="n">s</span> <span class="mi">10000</span>
    <span class="o">--</span><span class="n">n</span> <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span>         <span class="o">:=</span>  <span class="n">Normalization</span> <span class="n">method</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">--</span><span class="n">n</span> <span class="n">TTR</span>
    <span class="o">-</span><span class="n">a</span>                   <span class="o">:=</span>  <span class="n">Perform</span> <span class="n">adaptive</span> <span class="n">resampling</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="n">Turned</span> <span class="n">Off</span><span class="o">.</span>
    <span class="o">--</span><span class="n">PC</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>         <span class="o">:=</span>  <span class="n">Pseudocounts</span> <span class="n">used</span> <span class="ow">in</span> <span class="n">calculating</span> <span class="n">LFC</span><span class="o">.</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span>
    <span class="o">--</span><span class="n">iN</span> <span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span>           <span class="o">:=</span>  <span class="n">Ignore</span> <span class="n">TAs</span> <span class="n">occurring</span> <span class="n">within</span> <span class="n">given</span> <span class="n">percentage</span> <span class="p">(</span><span class="k">as</span> <span class="n">integer</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">N</span> <span class="n">terminus</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">--</span><span class="n">iN</span> <span class="mi">0</span>
    <span class="o">--</span><span class="n">iC</span> <span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span>           <span class="o">:=</span>  <span class="n">Ignore</span> <span class="n">TAs</span> <span class="n">occurring</span> <span class="n">within</span> <span class="n">given</span> <span class="n">percentage</span> <span class="p">(</span><span class="k">as</span> <span class="n">integer</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">C</span> <span class="n">terminus</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">--</span><span class="n">iC</span> <span class="mi">0</span>
    <span class="o">--</span><span class="n">ctrl_lib</span> <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span>  <span class="o">:=</span>  <span class="n">String</span> <span class="n">of</span> <span class="n">letters</span> <span class="n">representing</span> <span class="n">library</span> <span class="n">of</span> <span class="n">control</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">order</span>
                             <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="s1">&#39;AABB&#39;</span><span class="o">.</span> <span class="n">Default</span> <span class="n">empty</span><span class="o">.</span> <span class="n">Letters</span> <span class="n">used</span> <span class="n">must</span> <span class="n">also</span> <span class="n">be</span> <span class="n">used</span> <span class="ow">in</span> <span class="o">--</span><span class="n">exp_lib</span>
                             <span class="n">If</span> <span class="n">non</span><span class="o">-</span><span class="n">empty</span><span class="p">,</span> <span class="n">resampling</span> <span class="n">will</span> <span class="n">limit</span> <span class="n">permutations</span> <span class="n">to</span> <span class="n">within</span><span class="o">-</span><span class="n">libraries</span><span class="o">.</span>
    <span class="o">--</span><span class="n">exp_lib</span> <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span>   <span class="o">:=</span>  <span class="n">String</span> <span class="n">of</span> <span class="n">letters</span> <span class="n">representing</span> <span class="n">library</span> <span class="n">of</span> <span class="n">experimental</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">order</span>
                             <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="s1">&#39;ABAB&#39;</span><span class="o">.</span> <span class="n">Default</span> <span class="n">empty</span><span class="o">.</span> <span class="n">Letters</span> <span class="n">used</span> <span class="n">must</span> <span class="n">also</span> <span class="n">be</span> <span class="n">used</span> <span class="ow">in</span> <span class="o">--</span><span class="n">ctrl_lib</span>
                             <span class="n">If</span> <span class="n">non</span><span class="o">-</span><span class="n">empty</span><span class="p">,</span> <span class="n">resampling</span> <span class="n">will</span> <span class="n">limit</span> <span class="n">permutations</span> <span class="n">to</span> <span class="n">within</span><span class="o">-</span><span class="n">libraries</span><span class="o">.</span>
    <span class="o">-</span><span class="n">winz</span>                <span class="o">:=</span>  <span class="n">winsorize</span> <span class="n">insertion</span> <span class="n">counts</span> <span class="k">for</span> <span class="n">each</span> <span class="n">gene</span> <span class="ow">in</span> <span class="n">each</span> <span class="n">condition</span>
                            <span class="p">(</span><span class="n">replace</span> <span class="nb">max</span> <span class="n">cnt</span> <span class="ow">in</span> <span class="n">each</span> <span class="n">gene</span> <span class="k">with</span> <span class="mi">2</span><span class="n">nd</span> <span class="n">highest</span><span class="p">;</span> <span class="n">helps</span> <span class="n">mitigate</span> <span class="n">effect</span> <span class="n">of</span> <span class="n">outliers</span><span class="p">)</span>
    <span class="o">-</span><span class="n">no</span><span class="o">-</span><span class="n">sr</span>               <span class="o">:=</span>  <span class="n">disable</span> <span class="n">site</span><span class="o">-</span><span class="n">restricted</span> <span class="n">resampling</span><span class="p">;</span> <span class="n">less</span> <span class="n">sensitive</span><span class="p">,</span> <span class="n">might</span> <span class="n">be</span> <span class="n">more</span> <span class="n">conservative</span> <span class="k">for</span> <span class="n">finding</span> <span class="n">significant</span> <span class="n">conditionally</span> <span class="n">essential</span> <span class="n">genes</span>
</pre></div>
</div>
</div>
<div class="section" id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h2>
<p>The resampling method is non-parametric, and therefore does not require
any parameters governing the distributions or the model. The following
parameters are available for the method:</p>
<ul class="simple">
<li><p><strong>Samples:</strong> The number of samples (permutations) to perform. The
larger the number of samples, the more resolution the p-values
calculated will have, at the expense of longer computation time. The
resampling method runs on 10,000 samples by default.</p></li>
<li><p><strong>Adaptive Resampling:</strong> An optional “adaptive” version of resampling
which accelerates the calculation by terminating early for genes
which are likely not significant. This dramatically speeds up the
computation at the cost of less accurate estimates for those genes
that terminate early (i.e. deemed not significant). This option is
OFF by default. (see Notes below)</p></li>
<li><p><strong>Include Zeros:</strong> Select to include  sites that are zero. This is the
preferred behavior, however, unselecting this (thus ignoring sites that)
are zero accross all dataset (i.e. completely empty), is useful for
decreasing running time (specially for large datasets like Tn5).</p></li>
<li><p><strong>Normalization Method:</strong> Determines which normalization method to
use when comparing datasets. Proper normalization is important as it
ensures that other sources of variability are not mistakenly treated
as real differences. See the <a class="reference internal" href="normalize_method.html#normalization"><span class="std std-ref">Normalization</span></a> section for a description
of normalization method available in TRANSIT.</p></li>
<li><p><strong>--ctrl_lib, --exp_lib:</strong> These are for doing resampling with datasets from multiple libraries, see below.</p></li>
<li><p><strong>–iN, –iC:</strong> Trimming of TA sites near N- and C-terminus.
The default for trimming TA sites in the termini of ORFs is 0.
However, TA sites in the stop codon (e.g. TAG) are automatically excluded.
Trimming is specified as a percentage (as an integer), so, for example,
if you want to trim TA sites within 5% of the termini, you would
add the flags ‘–iN 5 –iC 5’ (not 0.05).</p></li>
<li><p><strong>--PC</strong>: Pseudocounts used in calculation of LFCs (log-fold-changes, see Output and Diagnostics) in
resampling output file.
To suppress the appearance of artifacts due to high-magnitude of LFCs from
genes with low insertion counts (which
are more susceptible to noise), one can increase the pseudocounts using <a href="#id2"><span class="problematic" id="id3">`</span></a>–PC’.
Increasing PC to a value like 5 (which is
reasonable, given that TTR normalization scales data so average insertion counts is around 100)
can further reduce the appearance of artifacts (genes with low counts but large LFCs).
However, changing pseudocounts only affects the LFCs, and will not change the number of significant genes.</p></li>
<li><p><strong>-winz</strong>: <a class="reference external" href="https://en.wikipedia.org/wiki/Winsorizing">winsorize</a> insertion counts for each gene in each condition.
Replace max count in each gene with 2nd highest.  This can help mitigate effect of outliers.</p></li>
<li><p><strong>-no-sr</strong>: Turn off site based resampling. It makes the method less sensitive, reporting less significantly conditionally essential genes.
It also the user to permute counts over all TA sites pooled rather than restrict permutations of insertion counts in a gene to each individual TA site</p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>I recommend using <strong>-a (adaptive resampling)</strong>. It runs much faster, and the p-values
will be very close to a full non-adaptive run (all 10,000 samples).</p>
</div>
<p>Occasionally, people ask if resampling can be done on intergenic regions as well.
It could be done pretty easily (for example by making a prot_table with coordinates
for the regions between genes).  But it is usually not worthwhile, because most
intergenic regions are small (&lt;100 bp) contain very few TA sites (often 0-2),
making it difficult to make confident calls on essentiality.</p>
</div>
<div class="section" id="command-line-examples">
<h2>Command Line Examples<a class="headerlink" href="#command-line-examples" title="Permalink to this headline">¶</a></h2>
<p>Resampling can also now take a <a href="#id4"><span class="problematic" id="id5">combined_wig_</span></a> file as input (containing insertion counts
for multiple sample), along with a <a href="#id6"><span class="problematic" id="id7">samples_metadata_</span></a> file
that describes the samples.
If you want to compare more than two conditions, see <a class="reference internal" href="zinb_method.html#zinb"><span class="std std-ref">ZINB</span></a>.</p>
<p>Run Resampling with a Combined Wig File:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python3</span> <span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">resampling</span> <span class="n">antibiotic_combined_wig</span><span class="o">.</span><span class="n">txt</span> <span class="n">antibiotic_samples_metadata</span><span class="o">.</span><span class="n">txt</span> <span class="n">Untreated</span> <span class="n">Isoniazid</span> <span class="n">H37Rv</span><span class="o">.</span><span class="n">prot_table</span> <span class="n">results</span><span class="o">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">a</span>
</pre></div>
</div>
<p>Run Resampling with Individual Wig Files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python3</span> <span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">resampling</span> <span class="n">glycerol_rep1</span><span class="o">.</span><span class="n">txt</span><span class="p">,</span><span class="n">glycerol_rep2</span><span class="o">.</span><span class="n">txt</span> <span class="n">cholesterol_rep1</span><span class="o">.</span><span class="n">txt</span><span class="p">,</span><span class="n">cholesterol_rep2</span><span class="o">.</span><span class="n">txt</span> <span class="n">H37Rv</span><span class="o">.</span><span class="n">prot_table</span> <span class="n">results</span><span class="o">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">a</span>
</pre></div>
</div>
</div>
<div class="section" id="doing-resampling-with-datasets-from-different-libraries">
<h2>Doing resampling with datasets from different libraries<a class="headerlink" href="#doing-resampling-with-datasets-from-different-libraries" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Currently supported only in TRANSIT 3.2.X</strong></p>
</div>
<p>In most cases, comparisons are done among samples (replicates) from
the same library evaluated in two different conditions.  But if the
samples themselves come from different libraries, then this could
introduce extra variability, the way resampling is normally done.  To
compensate for this, if you specify which libraries each dataset comes
from, the permutations will be restricted to permuting counts only
among samples within each library.  Statistical significance is still
determined from all the data in the end (by comparing the obversed
difference of means between the two conditions to a null distribution).
Of course, this method makes most sense when you have at least 1 replicate
from each library in each condition.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="doing-resampling-between-different-strains">
<h2>Doing resampling between different strains<a class="headerlink" href="#doing-resampling-between-different-strains" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Currently supported only in TRANSIT 3.2.X</strong></p>
</div>
<p>The most common case is that resampling is done among replicates all
from the same Tn library, and hence all the datasets (fastq files) are
mapped to the same refence genome.  Occasionally, it is useful to
compare TnSeq datasets between two different strains, such as a
reference strain and a clinical isolate from a different lineage.
Suppose for simplicity that you want to compare one replicate from
strain A (e.g. H37Rv) and one replicate from strain B (e.g. CDC1551).
Resampling was not originally designed to handle this case.  The
problem is that the TA sites in the .wig files with insertion counts
might have different coordinates (because of shifts due to indels
between the genomes).  Furthermore, a given gene might not even have
the same number of TA sites in the two strains (due to SNPs).  A
simplistic solution is to just map both datasets to the same genome
sequence (say H37Rv, for example).  Then a resampling comparison could
be run as usual, because the TA sites would all be on the same
coordinate system. This is not ideal, however, because some reads of
strain B might not map properly to genome A due to SNPs or indels
between the genomes.  In fact, in more divergent organisms with higher
genetic diversity, this can cause entire regions to look artificially
essential, because reads fail to map in genes with a large number of
SNPs, resulting in the apparent absence of transposon insertions.</p>
<p>A better approach is to map each library to the custom genome sequence
of its own strain (using TPP).  It turns out the resampling can still
be applied (since it is fundamentally a test on the difference of the
<em>mean</em> insertion count in each gene).  The key to making this work,
aside from mapping each library to its own genome sequence, is that
you need an annotation (prot_table) for the second strain that has
been “adapted” from the first strain.  This is because,
to do a comparison between conditions for a gene, Transit needs to be
able to determine which TA sites fall in that gene for each strain.
This can be achieved by producing a “modified” prot_table, where the
START and END coordinates of each ORF in strain B have been adjusted
according to an alignment between genome A and genome B. (If you need
help with this step, contact: <a class="reference external" href="mailto:ioerger&#37;&#52;&#48;cs&#46;tamu&#46;edu">ioerger<span>&#64;</span>cs<span>&#46;</span>tamu<span>&#46;</span>edu</a>).  In other words, the
app allows you to create ‘B.prot_table’ from ‘A.prot_table’ (and ‘A.fna’
and ‘B.fna’).</p>
<p>Once you have created B.prot_table, all you need to do is provide
<em>both</em> prot_tables to resampling (either through the GUI, or on the
command-line), as a comma-separated list.  For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python3</span> <span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">resampling</span> <span class="n">Rv_1_H37Rv</span><span class="o">.</span><span class="n">wig</span><span class="p">,</span><span class="n">Rv_2_H37Rv</span><span class="o">.</span><span class="n">wig</span> <span class="mi">632_1_632</span><span class="n">WGS</span><span class="o">.</span><span class="n">wig</span><span class="p">,</span><span class="mi">632_2_632</span><span class="n">WGS</span><span class="o">.</span><span class="n">wig</span> <span class="n">H37Rv</span><span class="o">.</span><span class="n">prot_table</span><span class="p">,</span><span class="mi">632</span><span class="n">WGS</span><span class="o">.</span><span class="n">prot_table</span> <span class="n">resampling_output</span><span class="o">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">a</span>
</pre></div>
</div>
<p>In this example, 2 replicates from H37Rv (which had been mapped to
H37Rv.fna by TPP) were compared to 2 replicates from strain 632 (which
had been mapped to 632WGS.fna, the custom genome seq for strain 632).
The important point is that <strong>two annotations</strong> are given in the 3rd
arg on the command-line: <strong>H37Rv.prot_table,632WGS.prot_table</strong>.  The
assumption is that the ORF boundaries for H37Rv will be used to find
TA sites in Rv_1_H37Rv.wig and Rv_2_H37Rv.wig, and the ORF boundaries
in 632WGS.prot_table (which had been adapted from H37Rv.prot_table
using the web app above) will be used to find TA sites in the
corrsponding regions in 632_1_632WGS.wig and 632_2_632WGS.wig.</p>
<p>Note that, in contrast to handling datasets from different libraries
disucssed above, in this case, the assumption is that all replicates
in condition A will be from one library (and one strain), and all
replicates in condition B will be from another library (another strain).</p>
</div>
<div class="section" id="gui-mode">
<h2>GUI Mode<a class="headerlink" href="#gui-mode" title="Permalink to this headline">¶</a></h2>
<p>The resampling analysis method can be selected from the “Method” tab in the Menu Bar.</p>
<a class="reference internal image-reference" href="_images/resampling_gui_selection.png"><img alt="_images/resampling_gui_selection.png" class="align-center" src="_images/resampling_gui_selection.png" style="width: 1000px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The parameters to input through the parameter panel for the method is equivalent to the command line usage (see parameter descriptions above for full detail):</p>
<a class="reference internal image-reference" href="_images/resampling_parameter_panel.png"><img alt="_images/resampling_parameter_panel.png" class="align-center" src="_images/resampling_parameter_panel.png" style="width: 1000px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="output-and-diagnostics">
<h2>Output and Diagnostics<a class="headerlink" href="#output-and-diagnostics" title="Permalink to this headline">¶</a></h2>
<p>The resampling method outputs a tab-delimited file with results for each
gene in the genome. P-values are adjusted for multiple comparisons using
the Benjamini-Hochberg procedure (called “q-values” or “p-adj.”). A
typical threshold for conditional essentiality on is q-value &lt; 0.05.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 79%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column Header</p></th>
<th class="head"><p>Column Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ORF</p></td>
<td><p>Gene ID.</p></td>
</tr>
<tr class="row-odd"><td><p>Gene Name</p></td>
<td><p>Name of the gene.</p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>Gene description.</p></td>
</tr>
<tr class="row-odd"><td><p>Sites</p></td>
<td><p>Number of TA sites in the gene.</p></td>
</tr>
<tr class="row-even"><td><p>Mean Ctrl</p></td>
<td><p>Mean of read counts in condition 1. (avg over TA sites and reps)</p></td>
</tr>
<tr class="row-odd"><td><p>Mean Exp</p></td>
<td><p>Mean of read counts in condition 2.</p></td>
</tr>
<tr class="row-even"><td><p>Log 2 FC</p></td>
<td><p>Log-fold-change of exp (treatment) over ctrl (untreated)</p></td>
</tr>
<tr class="row-odd"><td><p>Sum Ctrl</p></td>
<td><p>Sum of read counts in condition 1.</p></td>
</tr>
<tr class="row-even"><td><p>Sum Exp</p></td>
<td><p>Sum of read counts in condition 2.</p></td>
</tr>
<tr class="row-odd"><td><p>Delta Mean</p></td>
<td><p>Difference in the MEAN insertion counts.</p></td>
</tr>
<tr class="row-even"><td><p>P Value</p></td>
<td><p>P-value calculated by the permutation test.</p></td>
</tr>
<tr class="row-odd"><td><p>Adj P Value</p></td>
<td><p>Adjusted p-value controlling for the FDR (Benjamini-Hochberg)</p></td>
</tr>
</tbody>
</table>
<p><strong>log2FC:</strong> (log-fold-change, LFC)
For each gene, the LFC is calculated as the log-base-2 of the
ratio of mean insertion counts in the experimental (treated) condition vs. the
control condition (untreated, reference).
The default is PC=1, which avoids the result being undefined
for genes with means of 0 in either condition.  Pseudocounts can be
changed using the -PC flag (above).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LFC</span> <span class="o">=</span> <span class="n">log2</span><span class="p">((</span><span class="n">mean_insertions_in_exp</span> <span class="o">+</span> <span class="n">PC</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mean_insertions_in_ctrl</span> <span class="o">+</span> <span class="n">PC</span><span class="p">))</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="run-time">
<h2>Run-time<a class="headerlink" href="#run-time" title="Permalink to this headline">¶</a></h2>
<p>A typical run of the resampling method with 10,000 samples will take
around 45 minutes (with the histogram option ON [GUI only]). Using the <em>adaptive
resampling</em> option (-a), the run-time is reduced to around 10 minutes.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="transit-sectionend docutils" />
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="utest_method.html" class="btn btn-neutral float-right" title="Mann-Whitney U-test (utest)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="ttnfitness_method.html" class="btn btn-neutral float-left" title="TTN-Fitness" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2015, Michael A. DeJesus &amp; Thomas R. Ioerger.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
   

</body>
</html>